{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/**\n * Created by anthrax on 10/4/16.\n */\nimport WSService from './services/WSService';\nimport BinaryHeap from './services/BinaryHeap';\nimport QueueService from './services/QueueService';\nimport { WEBSOCKET_URL, DELAY, TABLE_HEAD_HTML } from './consts';\n\nconst WebSocket = new WSService(WEBSOCKET_URL);\nconst heap = new BinaryHeap(((item) => Math.abs(item.lastChangeBid)));\nconst queue = new QueueService();\n\nvar tableCreate = function(data) {\n  var tbl = document.createElement('table');\n  tbl.id = \"currency-dashboard\";\n  var tbdy = document.createElement('tbody');\n  data.forEach((item) => {\n    let tr = document.createElement('tr');\n    let name = document.createElement('td');\n    let bestBid = document.createElement('td');\n    let bestAsk = document.createElement('td');\n    let openBid = document.createElement('td');\n    let lastChangeBid = document.createElement('td');\n\n    let sparkline = document.createElement('td');\n    var el = document.createElement('span');\n    var sparkline1 = new Sparkline(sparkline);\n    sparkline1.draw(item.midPrice);\n    if(item.name == \"gbpjpy\"){\n      console.log(item.midPrice.length);\n    }\n    name.appendChild(document.createTextNode(item.name));\n    bestBid.appendChild(document.createTextNode(item.bestBid));\n    bestAsk.appendChild(document.createTextNode(item.bestAsk));\n    openBid.appendChild(document.createTextNode(item.openBid));\n    lastChangeBid.appendChild(document.createTextNode(item.lastChangeBid));\n    tr.appendChild(name);\n    tr.appendChild(bestBid);\n    tr.appendChild(bestAsk);\n    tr.appendChild(openBid);\n    tr.appendChild(lastChangeBid);\n    tr.appendChild(sparkline);\n    tbdy.appendChild(tr);\n  });\n  tbl.appendChild(tbdy);\n  return tbl;\n};\n\n\n\n\n// connect and subscribe\nWebSocket\n  .connect()\n  .then((success) => WebSocket.subscribe('/fx/prices', (message) => queue.add(JSON.parse(message.body))))\n  .catch((error) => console.error(error));\n\n\n\n\n\nwindow.setInterval(() => {\n  var data = [];\n  queue.getData().forEach((item) => heap.push(item));\n  while (heap.size() > 0) {data.push(heap.pop())}\n  var tableEl = document.getElementById('currency-dashboard');\n  let parentEl = tableEl.parentNode;\n  parentEl.replaceChild(tableCreate(data), tableEl);\n  /*\n  var table = \"<table>content</table>\";\n  table += \"\";\n  var mask = TABLE_HEAD_HTML;\n  mask += \"<tbody>\";\n  data.forEach((item) => {\n    mask += '' +\n      '<tr>' +\n        ' <td>' + item.name + '</td> ' +\n        ' <td>' + item.bestBid + '</td> ' +\n        ' <td>' + item.bestAsk + '</td> ' +\n        ' <td>' + item.openBid + '</td> ' +\n        ' <td>' + item.lastChangeBid + '</td> ' +\n        '<td id=\"sparks-\"+item.name>&nbsp</td>' +\n      '</tr>';\n  });\n  mask += \"</tbody>\";\n  appEl.innerHTML = table.replace('content', mask);\n  */\n}, DELAY);\n\n\n\n\n"]}